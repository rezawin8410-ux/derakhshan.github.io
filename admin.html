<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª Ù¾ÛŒØ´Ø±ÙØªÙ‡ â€“ Ø¯Ø±Ø®Ø´Ø§Ù†</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.rtl.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
<!-- Quill, Prism, Sortable, Chart, Lottie, etc. -->
<link href="https://cdn.quilljs.com/1.3.7/quill.snow.css" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet">
<style>
:root{--primary:#00bfa5;--accent:#ff6f00;--bg:#f5f5f5}
body{font-family:Vazir,Tahoma;background:var(--bg);margin:0}
.section{background:#fff;border-radius:10px;padding:20px;margin-bottom:25px}
h2{color:var(--primary);margin-bottom:15px}
label{font-weight:700}
.ql-container{min-height:150px}
.preview-box img{max-width:100%;border-radius:8px;margin:5px}
</style>
</head>
<body>
<div class="container-fluid mt-3">
  <h1 class="text-center mb-4">Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª Ù¾ÛŒØ´Ø±ÙØªÙ‡ â€“ Ø¯Ø±Ø®Ø´Ø§Ù†</h1>

  <!-- LOGIN -->
  <div id="loginBox" class="section" style="max-width:400px;margin:auto">
    <h2>ÙˆØ±ÙˆØ¯ Ù…Ø¯ÛŒØ±</h2>
    <input type="password" id="pass" class="form-control mb-2" placeholder="Ø±Ù…Ø² Ø¹Ø¨ÙˆØ±">
    <button class="btn btn-success w-100" onclick="login()">ÙˆØ±ÙˆØ¯</button>
    <p id="msg" class="text-danger mt-2"></p>
  </div>

  <!-- PANEL -->
  <div id="panel" style="display:none">
    <!-- 1ï¸âƒ£ ØªÙ… Ùˆ Ø±Ù†Ú¯ -->
    <div class="section">
      <h2>ğŸ¨ ØªÙ… Ùˆ Ø±Ù†Ú¯</h2>
      <div class="row">
        <div class="col-md-3"><label>Primary</label><input type="color" id="col_primary" class="form-control"></div>
        <div class="col-md-3"><label>Accent</label><input type="color" id="col_accent" class="form-control"></div>
        <div class="col-md-3"><label>Text</label><input type="color" id="col_text" class="form-control"></div>
        <div class="col-md-3"><label>Background</label><input type="color" id="col_bg" class="form-control"></div>
      </div>
      <label>Dark Mode</label>
      <select id="switch_dark" class="form-select mb-2" onchange="saveTheme()">
        <option value="light">Ø±ÙˆØ´Ù†</option><option value="dark">ØªÛŒØ±Ù‡</option>
      </select>
      <button class="btn btn-primary" onclick="saveTheme()">Ø°Ø®ÛŒØ±Ù‡ ØªÙ…</button>
    </div>

    <!-- 2ï¸âƒ£ Ú†ÛŒØ¯Ù…Ø§Ù† Ùˆ Ø´Ø¨Ú©Ù‡ -->
    <div class="section">
      <h2>ğŸ§± Ú†ÛŒØ¯Ù…Ø§Ù† Ùˆ Ø´Ø¨Ú©Ù‡</h2>
      <label>Layout Type</label>
      <select id="layout_type" class="form-select mb-2">
        <option value="responsive">Responsive</option>
        <option value="fluid">Fluid</option>
        <option value="fixed">Fixed</option>
      </select>
      <label>Max Container Width (px)</label><input type="number" id="layout_max" class="form-control mb-2" value="1200">
      <label>Breakpoint XL (px)</label><input type="number" id="layout_xl" class="form-control mb-2" value="1200">
      <button class="btn btn-primary" onclick="saveLayout()">Ø°Ø®ÛŒØ±Ù‡ Ú†ÛŒØ¯Ù…Ø§Ù†</button>
    </div>

    <!-- 3ï¸âƒ£ ÙˆÛŒØ±Ø§ÛŒØ´Ú¯Ø± WYSIWYG -->
    <div class="section">
      <h2>âœï¸ ÙˆÛŒØ±Ø§ÛŒØ´Ú¯Ø± Ù…Ø­ØªÙˆØ§</h2>
      <div id="editor_wysiwyg" class="border"></div>
      <button class="btn btn-success mt-2" onclick="saveWysiwyg()">Ø°Ø®ÛŒØ±Ù‡ Ù…Ø­ØªÙˆØ§</button>
    </div>

    <!-- 4ï¸âƒ£ Ø§Ù„Ù…Ø§Ù†â€ŒÙ‡Ø§ÛŒ Ø¨ØµØ±ÛŒ -->
    <div class="section">
      <h2>ğŸ¨ Ø§Ù„Ù…Ø§Ù†â€ŒÙ‡Ø§ÛŒ Ø¨ØµØ±ÛŒ</h2>
      <label>Ù†ÙˆØ¹ Ø§Ø³Ù„Ø§ÛŒØ¯Ø±</label>
      <select id="slider_type" class="form-select mb-2">
        <option value="fade">Fade</option><option value="slide">Slide</option>
      </select>
      <label>Ø³Ø±Ø¹Øª Ø§Ø³Ù„Ø§ÛŒØ¯Ø± (ms)</label><input type="number" id="slider_speed" class="form-control mb-2" value="4000">
      <button class="btn btn-primary" onclick="saveVisual()">Ø°Ø®ÛŒØ±Ù‡ ÙˆÛŒÚ˜ÙˆØ§Ù„</button>
    </div>

    <!-- 5ï¸âƒ£ Ø§Ø¨Ø²Ø§Ø± Ù¾ÛŒØ´Ø±ÙØªÙ‡ -->
    <div class="section">
      <h2>ğŸ§ª Ø§Ø¨Ø²Ø§Ø± Ù¾ÛŒØ´Ø±ÙØªÙ‡</h2>
      <label>Enable Lazy Load</label>
      <input type="checkbox" id="opt_lazy" class="form-check-input mb-2">
      <label>Enable A/B Test</label>
      <input type="checkbox" id="opt_ab" class="form-check-input mb-2">
      <button class="btn btn-primary" onclick="saveAdvanced()">Ø°Ø®ÛŒØ±Ù‡ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù¾ÛŒØ´Ø±ÙØªÙ‡</button>
    </div>

    <!-- 6ï¸âƒ£ Ø§Ù…Ù†ÛŒØª -->
    <div class="section">
      <h2>ğŸ” Ø§Ù…Ù†ÛŒØª</h2>
      <label>ÙØ¹Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ Û²FA</label>
      <input type="checkbox" id="opt_2fa" class="form-check-input mb-2">
      <label>Ù…Ø­Ø¯ÙˆØ¯ÛŒØª IP</label>
      <textarea id="ip_list" class="form-control" rows="2" placeholder="Ù‡Ø± IP Ø¯Ø± ÛŒÚ© Ø³Ø·Ø±"></textarea>
      <button class="btn btn-primary" onclick="saveSecurity()">Ø°Ø®ÛŒØ±Ù‡ Ø§Ù…Ù†ÛŒØª</button>
    </div>

    <!-- 7ï¸âƒ£ Ø±Ø³Ø§Ù†Ù‡ -->
    <div class="section">
      <h2>ğŸ—‚ï¸ Ø±Ø³Ø§Ù†Ù‡</h2>
      <input type="file" multiple accept="image/*" onchange="uploadMedia(event)">
      <div id="mediaLibrary" class="row g-2 mt-2"></div>
    </div>

    <!-- 8ï¸âƒ£ Ú¯Ø²Ø§Ø±Ø´ -->
    <div class="section">
      <h2>ğŸ“Š Ú¯Ø²Ø§Ø±Ø´â€ŒÚ¯ÛŒØ±ÛŒ</h2>
      <canvas id="chart" height="200"></canvas>
      <button class="btn btn-sm btn-outline-info" onclick="exportReport()">Ø®Ø±ÙˆØ¬ÛŒ CSV</button>
    </div>

    <!-- 9ï¸âƒ£ Ø¨Ú©â€ŒØ¢Ù¾ -->
    <div class="section">
      <h2>ğŸ“¦ Ø¨Ú©â€ŒØ¢Ù¾ / Ø¨Ø§Ø²Ú¯Ø±Ø¯Ø§Ù†ÛŒ</h2>
      <button class="btn btn-success" onclick="exportBackup()">Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø¨Ú©â€ŒØ¢Ù¾ Ú©Ø§Ù…Ù„</button>
      <input type="file" accept=".json" onchange="importBackup(event)" class="form-control mt-2">
    </div>

    <!-- ğŸ”Ÿ Ù„Ø§Ú¯ ÙØ¹Ø§Ù„ÛŒØª -->
    <div class="section">
      <h2>Ù„Ø§Ú¯ ÙØ¹Ø§Ù„ÛŒØªâ€ŒÙ‡Ø§</h2>
      <button class="btn btn-sm btn-info" onclick="showLog()">Ù†Ù…Ø§ÛŒØ´ Ù„Ø§Ú¯</button>
      <pre id="logBox" style="display:none;height:200px;overflow:auto;background:#f9f9f9;padding:10px;border-radius:5px"></pre>
    </div>

    <button class="btn btn-danger" onclick="logout()">Ø®Ø±ÙˆØ¬</button>
  </div>
</div>

<!-- Scripts -->
<script src="https://cdn.quilljs.com/1.3.7/quill.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script>
/* ---------- LOGIN ---------- */
const PASSWORD='admin1234';
function login(){
  if(document.getElementById('pass').value===PASSWORD){
    localStorage.setItem('isAdmin','true');
    document.getElementById('loginBox').style.display='none';
    document.getElementById('panel').style.display='block';
    initQuill();
    loadAll();
  }else{
    document.getElementById('msg').textContent='Ø±Ù…Ø² Ø§Ø´ØªØ¨Ø§Ù‡ Ø§Ø³Øª';
  }
}
function logout(){
  localStorage.removeItem('isAdmin');
  location.reload();
}
if(localStorage.getItem('isAdmin')==='true'){
  document.getElementById('loginBox').style.display='none';
  document.getElementById('panel').style.display='block';
  initQuill();
  loadAll();
}

/* ---------- Quill ---------- */
let quill;
function initQuill(){
  if(window.quill) return;
  quill = new Quill('#editor_wysiwyg',{theme:'snow'});
}

/* ---------- Load All ---------- */
function loadAll(){
  /* Theme */
  const t=JSON.parse(localStorage.getItem('siteTheme'))||{};
  document.getElementById('col_primary').value=t.primary||'#00bfa5';
  document.getElementById('col_accent').value=t.accent||'#ff6f00';
  document.getElementById('col_text').value=t.text||'#004d40';
  document.getElementById('col_bg').value=t.bg||'#e0f7fa';
  document.getElementById('switch_dark').value=t.dark||'light';

  /* Layout */
  const l=JSON.parse(localStorage.getItem('siteLayout'))||{};
  document.getElementById('layout_type').value=l.type||'responsive';
  document.getElementById('layout_max').value=l.max||1200;
  document.getElementById('layout_xl').value=l.xl||1200;

  /* WYSIWYG */
  const w=JSON.parse(localStorage.getItem('wysiwygContent'))||'';
  if(quill) quill.root.innerHTML=w;

  /* Visual */
  const v=JSON.parse(localStorage.getItem('siteVisual'))||{};
  document.getElementById('slider_type').value=v.sliderType||'fade';
  document.getElementById('slider_speed').value=v.sliderSpeed||4000;

  /* Advanced */
  const a=JSON.parse(localStorage.getItem('siteAdvanced'))||{};
  document.getElementById('opt_lazy').checked=a.lazy||false;
  document.getElementById('opt_ab').checked=a.ab||false;

  /* Security */
  const s=JSON.parse(localStorage.getItem('siteSecurity'))||{};
  document.getElementById('opt_2fa').checked=s.twofa||false;
  document.getElementById('ip_list').value=(s.ips||[]).join('\n');

  /* Media */
  loadMedia();

  /* Chart */
  drawChart();
}

/* ---------- Save Functions ---------- */
function saveTheme(){
  const obj={
    primary:document.getElementById('col_primary').value,
    accent:document.getElementById('col_accent').value,
    text:document.getElementById('col_text').value,
    bg:document.getElementById('col_bg').value,
    dark:document.getElementById('switch_dark').value
  };
  localStorage.setItem('siteTheme',JSON.stringify(obj));
  logActivity('Ø°Ø®ÛŒØ±Ù‡ ØªÙ…');
  alert('ØªÙ… Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯');
}
function saveLayout(){
  const obj={
    type:document.getElementById('layout_type').value,
    max:Number(document.getElementById('layout_max').value),
    xl:Number(document.getElementById('layout_xl').value)
  };
  localStorage.setItem('siteLayout',JSON.stringify(obj));
  logActivity('Ø°Ø®ÛŒØ±Ù‡ Ú†ÛŒØ¯Ù…Ø§Ù†');
  alert('Ú†ÛŒØ¯Ù…Ø§Ù† Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯');
}
function saveWysiwyg(){
  const html=quill.root.innerHTML;
  localStorage.setItem('wysiwygContent',JSON.stringify(html));
  logActivity('Ø°Ø®ÛŒØ±Ù‡ Ù…Ø­ØªÙˆØ§ WYSIWYG');
  alert('Ù…Ø­ØªÙˆØ§ Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯');
}
function saveVisual(){
  const obj={
    sliderType:document.getElementById('slider_type').value,
    sliderSpeed:Number(document.getElementById('slider_speed').value)
  };
  localStorage.setItem('siteVisual',JSON.stringify(obj));
  logActivity('Ø°Ø®ÛŒØ±Ù‡ ÙˆÛŒÚ˜ÙˆØ§Ù„');
}
function saveAdvanced(){
  const obj={
    lazy:document.getElementById('opt_lazy').checked,
    ab:document.getElementById('opt_ab').checked
  };
  localStorage.setItem('siteAdvanced',JSON.stringify(obj));
  logActivity('Ø°Ø®ÛŒØ±Ù‡ Ù¾ÛŒØ´Ø±ÙØªÙ‡');
}
function saveSecurity(){
  const obj={
    twofa:document.getElementById('opt_2fa').checked,
    ips:document.getElementById('ip_list').value.split('\n').filter(Boolean)
  };
  localStorage.setItem('siteSecurity',JSON.stringify(obj));
  logActivity('Ø°Ø®ÛŒØ±Ù‡ Ø§Ù…Ù†ÛŒØª');
}
function uploadMedia(e){
  [...e.target.files].forEach(file=>{
    const r=new FileReader();
    r.onload=ev=>{
      const m=JSON.parse(localStorage.getItem('mediaLibrary'))||[];
      m.push({src:ev.target.result,name:file.name,size:file.size});
      localStorage.setItem('mediaLibrary',JSON.stringify(m));
      loadMedia();
    };
    r.readAsDataURL(file);
  });
}
function loadMedia(){
  const m=JSON.parse(localStorage.getItem('mediaLibrary'))||[];
  const ml=document.getElementById('mediaLibrary'); ml.innerHTML='';
  m.forEach((f,i)=>{
    ml.innerHTML+=`
      <div class="col-6 col-md-2">
        <img src="${f.src}" class="img-fluid rounded">
        <button class="btn btn-sm btn-danger" onclick="removeMedia(${i})">Ã—</button>
      </div>`;
  });
}
function removeMedia(i){
  const m=JSON.parse(localStorage.getItem('mediaLibrary'));
  m.splice(i,1);
  localStorage.setItem('mediaLibrary',JSON.stringify(m));
  loadMedia();
}
function drawChart(){
  const ctx=document.getElementById('chart').getContext('2d');
  new Chart(ctx,{
    type:'line',
    data:{
      labels:['ÙØ±ÙˆØ±Ø¯ÛŒÙ†','Ø§Ø±Ø¯ÛŒØ¨Ù‡Ø´Øª','Ø®Ø±Ø¯Ø§Ø¯','ØªÛŒØ±','Ù…Ø±Ø¯Ø§Ø¯'],
      datasets:[{label:'Ø¨Ø§Ø²Ø¯ÛŒØ¯',data:[120,190,300,500,200],borderColor:'#00bfa5',fill:false}]
    }
  });
}
function exportReport(){
  const data='data:text/csv;charset=utf-8,'+encodeURIComponent('Ù…Ø§Ù‡,Ø¨Ø§Ø²Ø¯ÛŒØ¯\nÙØ±ÙˆØ±Ø¯ÛŒÙ†,120\nØ§Ø±Ø¯ÛŒØ¨Ù‡Ø´Øª,190\nØ®Ø±Ø¯Ø§Ø¯,300\nØªÛŒØ±,500\nÙ…Ø±Ø¯Ø§Ø¯,200');
  const link=document.createElement('a'); link.href=data; link.download='report.csv'; link.click();
}
function exportBackup(){
  const keys=['siteTheme','siteLayout','wysiwygContent','siteVisual','siteAdvanced','siteSecurity','mediaLibrary','log'];
  const data=Object.fromEntries(keys.map(k=>[k,JSON.parse(localStorage.getItem(k))||{}]));
  const blob=new Blob([JSON.stringify(data,null,2)],{type:'application/json'});
  const url=URL.createObjectURL(blob);
  const a=document.createElement('a'); a.href=url; a.download='backup.json'; a.click();
  logActivity('Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø¨Ú©â€ŒØ¢Ù¾');
}
function importBackup(e){
  const file=e.target.files[0];
  if(!file) return;
  const r=new FileReader();
  r.onload=ev=>{
    const data=JSON.parse(ev.target.result);
    Object.keys(data).forEach(k=>localStorage.setItem(k,JSON.stringify(data[k])));
    loadAll();
    alert('Ø¨Ø§Ø²Ú¯Ø±Ø¯Ø§Ù†ÛŒ Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯');
    logActivity('Ø¨Ø§Ø²Ú¯Ø±Ø¯Ø§Ù†ÛŒ Ø§Ø² ÙØ§ÛŒÙ„');
  };
  r.readAsText(file);
}
function logActivity(action){
  const log=JSON.parse(localStorage.getItem('log'))||[];
  log.unshift({action,user:'Admin',time:new Date().toLocaleString('fa-IR')});
  if(log.length>100) log.pop();
  localStorage.setItem('log',JSON.stringify(log));
}
function showLog(){
  const log=JSON.parse(localStorage.getItem('log'))||[];
  document.getElementById('logBox').style.display='block';
  document.getElementById('logBox').textContent=log.map(l=>`${l.time} â€“ ${l.action}`).join('\n');
}
</script>
</body>
</html>
